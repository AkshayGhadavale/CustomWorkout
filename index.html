<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        <form action="" onsubmit="handleLogin(event)" id="loginForm">
            <input type="text" placeholder="enter email" id="email">
            <input type="text" placeholder="enter password" id="pass">
            <button type="submit">login</button>
        </form>
    </div>



    <script>
        function handleLogin(e){
            e.preventDefault()
            const email = document.querySelector('#email').value
            const pass = document.querySelector('#pass').value

            if(email!="" && pass!=""){
                const data = {
                    email: email,
                    password: pass
                }

                

                fetch("http://localhost:9000/user/login",{
                    method: "POST",
                    headers:{
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                }).then((res)=>{
                    if(!res.ok){
                        throw new Error('response was not ok')
                    }

                    return res.json()
                }).then(data=>{
                    if(data.token){
                        localStorage.setItem("token",data.token)
                        window.location.href = "home.html"
                    }
                }
                )
                .catch(err=>console.log(err))
            }
           
        }

    </script>
</body>
</html>